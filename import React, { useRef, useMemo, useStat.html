<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To Qing Liyin</title>
    <style>
        /* ================= 基础样式 ================= */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&display=swap');

        body {
            margin: 0;
            padding: 0;
            color: #fff;
            font-family: 'Noto Serif SC', 'SimHei', serif; 
            overflow: hidden;
            user-select: none;
            height: 100vh;
            
            /* 【修改点1】这里去掉了 ./images/，直接找 bg.jpg */
            background: url('bg.jpg') no-repeat center center fixed;
            background-size: cover;
            background-color: #000; /* 如果图片还没加载出来，先显示黑色 */
        }

        /* 背景遮罩 */
        .bg-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 0;
        }

        /* ================= 核心文字 ================= */
        .center-text-container {
            position: absolute;
            top: 45%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 5;
            text-align: center;
            width: 100%;
        }

        .main-name {
            font-size: 7rem; 
            margin: 0;
            font-weight: 900;
            color: rgba(255, 255, 255, 0.8); 
            text-shadow: 
                0 0 20px rgba(255, 105, 180, 0.8),
                0 0 50px rgba(255, 20, 147, 0.6);
            filter: blur(3px);
            letter-spacing: 15px;
            animation: breathe 4s ease-in-out infinite;
        }

        .sub-text {
            margin-top: 10px;
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.6);
            letter-spacing: 8px;
            text-transform: uppercase;
            text-shadow: 0 0 10px black;
            filter: blur(1px);
        }

        /* ================= 气球画布 ================= */
        canvas {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 10;
        }

        /* ================= UI 提示 ================= */
        .ui-layer {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 15;
            pointer-events: none;
            transition: opacity 1.5s ease;
        }

        .footer-tip {
            position: absolute;
            bottom: 40px;
            width: 100%;
            text-align: center;
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.9);
            letter-spacing: 4px;
            text-shadow: 0 0 5px #000;
            animation: pulse 2s infinite;
        }

        /* ================= 相册容器 ================= */
        .gallery-container {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 30;
            background: rgba(0, 0, 0, 0.92);
            opacity: 0;
            pointer-events: none;
            transition: opacity 2s ease;
            display: flex; align-items: center; justify-content: center;
        }
        .gallery-container.active { opacity: 1; pointer-events: auto; }

        .photo-frame {
            width: 85%; max-width: 500px;
            height: 70vh;
            position: relative; overflow: hidden;
            border-radius: 10px;
            box-shadow: 0 0 50px rgba(255, 105, 180, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .photo-track {
            display: flex; height: 100%;
            transition: transform 1.2s cubic-bezier(0.22, 1, 0.36, 1);
        }
        .photo-item {
            min-width: 100%; height: 100%;
            display: flex; justify-content: center; align-items: center;
            background: black;
        }
        .photo-item img {
            max-width: 100%; max-height: 100%;
            width: auto; height: auto; 
            object-fit: contain;
        }
        .final-caption {
            position: absolute; bottom: 10%; left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            padding: 15px 30px; border-radius: 50px;
            color: #fff; font-size: 2rem; white-space: nowrap;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 0 30px rgba(255, 105, 180, 0.5);
            animation: floatUp 2s ease forwards;
        }

        /* 动画定义 */
        @keyframes breathe { 
            0%, 100% { opacity: 0.8; transform: scale(1); } 
            50% { opacity: 1; transform: scale(1.02); text-shadow: 0 0 30px rgba(255, 105, 180, 1); } 
        }
        @keyframes pulse { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }
        @keyframes floatUp { from { opacity: 0; transform: translate(-50%, 30px); } to { opacity: 1; transform: translate(-50%, 0); } }

    </style>
</head>
<body>

    <div class="bg-overlay"></div>

    <div class="center-text-container">
        <h1 class="main-name">卿沥尹</h1> 
        <div class="sub-text">2025 · HAPPY NEW YEAR</div>
    </div>

    <canvas id="canvas"></canvas>

    <div class="ui-layer" id="uiLayer">
        <div class="footer-tip">
            [ 拨开人海见你 · 点击开启回忆 ]
        </div>
    </div>

    <div class="gallery-container" id="galleryLayer">
        <div class="photo-frame">
            <div class="photo-track" id="photoTrack"></div>
        </div>
    </div>

    <script>
        // ==========================================
        // 【配置区域 - 修改点2】 
        // 去掉了 ./images/，直接写文件名
        // 如果你的图片是 png 格式，记得把下面的 .jpg 改成 .png
        // ==========================================
        
        const photoList = [
            '1.jpg', '2.jpg', '3.jpg', '4.jpg',
            '5.jpg', '6.jpg', '7.jpg', '8.jpg',
            '9.jpg', '10.jpg', '11.jpg', '12.jpg',
            '13.jpg', '14.jpg', '15.jpg'
        ];
        const finalMessage = "卿沥尹天天开心，新年快乐！";

        // ==========================================
        // 逻辑部分 (保持不变)
        // ==========================================

        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const uiLayer = document.getElementById('uiLayer');
        const galleryLayer = document.getElementById('galleryLayer');
        const photoTrack = document.getElementById('photoTrack');

        let width, height;
        let particles = []; 
        let mouse = { x: -1000, y: -1000 }; 
        let isGalleryMode = false;

        function generateGallery() {
            let htmlContent = '';
            photoList.forEach((src, index) => {
                const isLast = index === photoList.length - 1;
                const captionHtml = isLast ? `<div class="final-caption">${finalMessage}</div>` : '';
                
                // 增加图片加载错误处理，如果图片没找到，会在控制台报错
                htmlContent += `
                    <div class="photo-item">
                        <img src="${src}" alt="Photo ${index + 1}" onerror="this.style.display='none';alert('找不到图片: ${src}，请检查文件名！')">
                        ${captionHtml}
                    </div>
                `;
            });
            photoTrack.innerHTML = htmlContent;
        }
        generateGallery();

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            initBalloons(); 
        }
        window.addEventListener('resize', resize);

        class Balloon {
            constructor(resetY = false) {
                this.init(resetY);
            }

            init(resetY) {
                this.x = Math.random() * width;
                this.y = resetY ? Math.random() * height : height + Math.random() * 100;
                this.size = Math.random() * 10 + 5; 
                this.speedY = Math.random() * 2 + 0.8; 
                this.swaySpeed = Math.random() * 0.05 + 0.02;
                this.swayOffset = Math.random() * Math.PI * 2;
                const colors = ['rgba(255, 20, 147, 0.85)', 'rgba(0, 191, 255, 0.8)', 'rgba(255, 215, 0, 0.85)', 'rgba(138, 43, 226, 0.8)', 'rgba(255, 255, 255, 0.7)'];
                this.color = colors[Math.floor(Math.random() * colors.length)];
            }

            update() {
                if(isGalleryMode) {
                    this.speedY += 0.5;
                }
                this.y -= this.speedY;
                this.x += Math.sin(Date.now() * 0.001 * this.speedY + this.swayOffset) * 0.5;

                const dx = mouse.x - this.x;
                const dy = mouse.y - this.y;
                const dist = Math.sqrt(dx * dx + dy * dy);
                if (dist < 150) {
                    const angle = Math.atan2(dy, dx);
                    const force = (150 - dist) / 150;
                    const push = 8 * force; 
                    this.x -= Math.cos(angle) * push;
                    this.y -= Math.sin(angle) * push;
                }
                if (this.y < -50 && !isGalleryMode) {
                    this.init(false);
                }
            }

            draw() {
                ctx.beginPath();
                ctx.ellipse(this.x, this.y, this.size * 0.8, this.size, 0, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.beginPath();
                ctx.moveTo(this.x, this.y + this.size);
                ctx.lineTo(this.x + Math.sin(this.y * 0.1) * 2, this.y + this.size + 15);
                ctx.strokeStyle = 'rgba(255,255,255,0.3)';
                ctx.lineWidth = 1;
                ctx.stroke();
                ctx.beginPath();
                ctx.ellipse(this.x - this.size * 0.3, this.y - this.size * 0.3, this.size * 0.2, this.size * 0.1, -Math.PI/4, 0, Math.PI * 2);
                ctx.fillStyle = 'rgba(255,255,255,0.4)';
                ctx.fill();
            }
        }

        function initBalloons() {
            particles = [];
            const count = window.innerWidth < 768 ? 150 : 300;
            for(let i=0; i<count; i++) { 
                particles.push(new Balloon(true));
            }
        }

        function animate() {
            ctx.clearRect(0, 0, width, height);
            particles.forEach(p => { p.update(); p.draw(); });
            requestAnimationFrame(animate);
        }

        window.addEventListener('mousemove', e => {
            mouse.x = e.clientX;
            mouse.y = e.clientY;
        });
        window.addEventListener('touchmove', e => {
            const touch = e.touches[0];
            mouse.x = touch.clientX;
            mouse.y = touch.clientY;
        });
        window.addEventListener('touchend', () => {
            mouse.x = -1000;
            mouse.y = -1000;
        });

        const enterAction = () => {
             if (!isGalleryMode) enterGalleryMode();
        };

        window.addEventListener('keydown', e => {
            if (e.code === 'Space') enterAction();
        });
        document.body.addEventListener('click', enterAction);

        function enterGalleryMode() {
            isGalleryMode = true;
            uiLayer.style.opacity = '0';
            document.querySelector('.center-text-container').style.opacity = '0';
            document.querySelector('.center-text-container').style.transition = 'opacity 0.8s';
            
            setTimeout(() => {
                galleryLayer.classList.add('active');
                startGalleryScroll();
            }, 1000);
        }

        function startGalleryScroll() {
            let index = 0;
            const total = photoList.length;
            setInterval(() => {
                index = (index + 1) % total;
                photoTrack.style.transform = `translateX(-${index * 100}%)`;
            }, 3500);
        }

        resize();
        initBalloons();
        animate();

    </script>
</body>
</html>